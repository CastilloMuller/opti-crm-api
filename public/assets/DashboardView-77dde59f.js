import{a0 as $,Q as z,r as v,c as E,p as M,u as O,v as e,D as s,C as b,I as i,N as l,a1 as Q,x as p,s as W,P as _}from"./vendor-1b1e291c.js";import{u as G,_ as H}from"./index-c4f35cf4.js";const J=()=>{{const a=window.location.protocol,d=window.location.host;return`${a}//${d}`}},y=$.create({baseURL:J(),headers:{"Content-Type":"application/json"},timeout:1e4});y.interceptors.request.use(a=>a,a=>(console.error("Request error:",a),Promise.reject(a)));y.interceptors.response.use(a=>a,a=>(a.response?console.error("Response error:",{status:a.response.status,data:a.response.data}):a.request?console.error("No response received:",a.request):console.error("Request setup error:",a.message),Promise.reject(a)));const K={class:"dashboard-view"},X={class:"dashboard-header"},Y={class:"header-actions"},Z={class:"connection-status"},ee={class:"quick-actions"},te={class:"dashboard-grid"},se={class:"lead-stats"},ae={class:"stat-item"},oe={class:"stat-value"},ne={class:"stat-item"},ie={class:"stat-value"},le={class:"stat-item"},ce={class:"stat-value"},re={class:"stat-item"},de={class:"stat-value"},ue={class:"stat-item"},pe={class:"stat-value"},ve=z({__name:"DashboardView",setup(a){const d=Q(),{isConnected:h}=G(),c=v({stats:{total:0,active:0,converted:0,conversionRate:"0%",value:0},recentActivity:[],recentLeads:[]}),w=v(new Date().toLocaleString()),C=v(!1),g=v(null),f=E(()=>({status:h.value?"Connected":"Disconnected",icon:h.value?"pi pi-check-circle":"pi pi-times-circle",class:h.value?"status-connected":"status-disconnected"}));async function D(){C.value=!0,g.value=null;try{const t=await y.get("/api/dashboard");t.data&&(c.value=t.data,w.value=new Date().toLocaleString())}catch(t){console.error("Error fetching dashboard data:",t),g.value=t.message||"Failed to fetch dashboard data"}finally{C.value=!1}}function A(){d.push("/leads?new=true")}function U(){d.push("/calendar?new=true")}function q(){d.push("/analytics")}function B(){d.push("/leads")}function P(t){t.data&&t.data.id&&d.push(`/leads/${t.data.id}`)}function L(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0)}function k(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function I(t){return{lead:"pi pi-user-plus",task:"pi pi-calendar",note:"pi pi-pencil",call:"pi pi-phone",email:"pi pi-envelope",meeting:"pi pi-users"}[t]||"pi pi-info-circle"}function j(t){return{new:"info",active:"warning",converted:"success",lost:"danger"}[t]||"info"}function R(t){return t.charAt(0).toUpperCase()+t.slice(1)}return M(()=>{D()}),(t,o)=>{const u=p("Button"),m=p("Panel"),r=p("Column"),S=p("DataTable"),F=p("Tag");return W(),O("div",K,[e("div",X,[o[0]||(o[0]=e("h1",null,"Dashboard",-1)),e("div",Y,[s(u,{label:"Refresh",icon:"pi pi-refresh",onClick:D,class:"p-button-outlined"})]),e("div",Z,[e("i",{class:b(f.value.icon)},null,2),e("span",{class:b(f.value.class)},i(f.value.status),3),e("small",null,"Last update: "+i(w.value),1)])]),e("div",ee,[s(u,{label:"New Lead",icon:"pi pi-plus",onClick:A,class:"p-button-success"}),s(u,{label:"Add Task",icon:"pi pi-calendar-plus",onClick:U}),s(u,{label:"View Analytics",icon:"pi pi-chart-line",onClick:q,class:"p-button-help"})]),e("div",te,[s(m,{header:"Lead Overview",class:"dashboard-panel"},{icons:l(()=>[s(u,{icon:"pi pi-arrow-right",onClick:B,class:"p-button-text p-button-sm"})]),default:l(()=>{var n,T,V,N,x;return[e("div",se,[e("div",ae,[e("div",oe,i(((n=c.value.stats)==null?void 0:n.total)||0),1),o[1]||(o[1]=e("div",{class:"stat-label"},"Total Leads",-1))]),e("div",ne,[e("div",ie,i(((T=c.value.stats)==null?void 0:T.active)||0),1),o[2]||(o[2]=e("div",{class:"stat-label"},"Active Leads",-1))]),e("div",le,[e("div",ce,i(((V=c.value.stats)==null?void 0:V.converted)||0),1),o[3]||(o[3]=e("div",{class:"stat-label"},"Converted",-1))]),e("div",re,[e("div",de,i(((N=c.value.stats)==null?void 0:N.conversionRate)||"0%"),1),o[4]||(o[4]=e("div",{class:"stat-label"},"Conversion Rate",-1))]),e("div",ue,[e("div",pe,i(L(((x=c.value.stats)==null?void 0:x.value)||0)),1),o[5]||(o[5]=e("div",{class:"stat-label"},"Total Value",-1))])])]}),_:1}),s(m,{header:"Recent Activity",class:"dashboard-panel"},{default:l(()=>[s(S,{value:c.value.recentActivity||[],class:"activity-timeline",rows:5},{default:l(()=>[s(r,{field:"type",header:"Type"},{body:l(({data:n})=>[e("i",{class:b(I(n.type)),style:{"margin-right":"0.5rem"}},null,2),_(" "+i(R(n.type)),1)]),_:1}),s(r,{field:"description",header:"Description"}),s(r,{field:"date",header:"Date"},{body:l(({data:n})=>[_(i(k(n.date)),1)]),_:1})]),_:1},8,["value"])]),_:1}),s(m,{header:"Recent Leads",class:"dashboard-panel"},{default:l(()=>[s(S,{value:c.value.recentLeads||[],class:"recent-leads-table",rows:5,onRowClick:P,style:{cursor:"pointer"}},{default:l(()=>[s(r,{field:"name",header:"Name"}),s(r,{field:"company",header:"Company"}),s(r,{field:"status",header:"Status"},{body:l(({data:n})=>[s(F,{value:R(n.status),severity:j(n.status)},null,8,["value","severity"])]),_:1}),s(r,{field:"value",header:"Value"},{body:l(({data:n})=>[_(i(L(n.value)),1)]),_:1}),s(r,{field:"lastContact",header:"Last Contact"},{body:l(({data:n})=>[_(i(k(n.lastContact)),1)]),_:1})]),_:1},8,["value"])]),_:1})])])}}});const fe=H(ve,[["__scopeId","data-v-8af65845"]]);export{fe as default};
